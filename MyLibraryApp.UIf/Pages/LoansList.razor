@page "/LoansList"
@using MyLibraryApp.Shared
@using MyLibraryApp.UIf.Services
@inject ILoanService LoanService

<h3>Loans</h3>
<div class="mb-3 loans-search">
    <input type="text" class="form-control" @bind="SearchTerm" @bind:event="oninput" placeholder="Keresés név vagy olvasószám alapján..." />
</div>


@if (_loans is not null)
{
    <table class="table table-hover">
        <thead>
        <tr>
            <td>Olvasószám</td>
            <td>Olvasó neve</td>
            <td>Könyv leltári száma</td>
            <td>Könyv</td>
            <td>Kölcsönzés dátuma</td>
            <td>Visszahozás dátuma</td>
        </tr>
        </thead>
        <tbody>
        @foreach (var loan in _loans)
        {
            <tr>
                <td>@loan.ReaderId</td> 
                <td>@loan.Reader</td>
                <td>@loan.BookId</td>
                <td>@loan.Book</td>
                <td>@loan.LoanDate</td>
                <td>@loan.ReturnDate</td>
            </tr>
        }
        </tbody>
    </table>
}

@code {
    private string SearchTerm = "";
    private List<LoanWithDetails> _loans;
    
    protected override async Task OnInitializedAsync()
    {
        _loans = await LoanService.GetAllAsync();
    }

}